/* ***** order collector ***** */
var orderPort=chrome.extension.connect({name:"priceComparesho9wbox-split"+location.href});orderPort.onMessage.addListener(function(a){if(a.name=="init_older"){var b="";if(location.href.indexOf("http://trade.jd.com/")!=-1){b="#order-submit b";bindClickToSubmitBtn("JD",b)};if(location.href.indexOf("http://cart.suning.com/")!=-1){b="#oneKeySub";bindClickToSubmitBtn("SUNING",b)};if(location.href.indexOf("http://buy.yhd.com/")!=-1){b="div[class='mallsettelment'] div[class='btOrderConfig'] button[class='btSubOrder1 noOrderSubmit1']";bindClickToSubmitBtn("YHD",b)};if(location.href.indexOf("http://g.gome.com.cn/")!=-1){b="#j-orderSubmitNew";setTimeout("bindClickToSubmitBtn('GUOMEI','#j-orderSubmitNew')",5000)};if(location.href.indexOf("http://buy.tmall.com/")!=-1){b="#J_Go";bindClickToSubmitBtn("TM",b)};if(location.href.indexOf("http://buy.yixun.com/")!=-1){b="#btn_order";bindClickToSubmitBtn("YXW",b)};if(location.href.indexOf("http://cart.jiuxian.com/")!=-1){b="span[class='subBtn'] i";bindClickToSubmitBtn("JX",b)}}});function get_JD_OrderJson(){var b={};var c="div[class='consignee-item item-selected'] div[class='user-name'] div[class='fl'] strong";var d="div[class='consignee-item item-selected'] div[class='mt10']";var e="div[class='consignee-item item-selected'] div[class='adr-m']";var f="div[class='consignee-item item-selected'] div[class='user-name'] div[class='fr']";var g="div[class='payment-item item-selected online-payment']";var h=".shopping-lists div[class='shopping-list'] div[class='goods-list'] div[class='goods-item goods-item-extra']";var i="div[class='p-name'] a";var j="div[class='p-name'] a";var k="div[class='p-price'] strong";var l="div[class='p-price'] span[class='ml20']";var m="strong#payPriceId";var n=$(c).text();var o=$(d).text()+$(e).text();var p=$(f).text();var q=$(g).text();var r="快递运输";var s="";var t=new Array();$(h).each(function(){var a={};a["goodName"]=$(this).find(i).text();a["goodWebUrl"]=$(this).find(j).attr("href");a["goodPrice"]=getPriceValue($(this).find(k).text());a["goodNumber"]=getPriceValue($(this).find(l).text());t.push(a)});var u=$(m).text();b["consignee"]=n.trim();b["phone"]=p;b["consigneeAddress"]=o;b["payMethod"]=q;b["expressMethod"]=r;b["superiorUrl"]=_pluginInfo.type;b["buyGoods"]=t;b["totalPrice"]=getPriceValue(u);b["mac"]="无";b["ip"]="无";return b};function get_JD2_OrderJson(){var b={};var c="strong#payPriceId";var d=".s-content p";var e="div[class='payment-selected']";var f="div[class='way-item']";var g=".review-tbody table[class='order-table'] tbody tr";var h="td[class='fore1'] a:eq(1)";var i="td[class='fore1'] a:eq(1)";var j="td[class='p-price'] strong";var k="td[class='fore2']";var l=$(d).html().split("<br>")[0].split("   ")[0].split("&nbsp;")[1];var m=$(d).html().split("<br>")[0].split("   ")[0].split("&nbsp;")[0];var n=$(d).html().split("<br>")[1];var o=$(e).text().split(" ")[0];var p="";$(f).each(function(){p+=$(this).text()});var q="";var r=$(c).text();var s=new Array();$(g).each(function(){var a={};a["goodName"]=$(this).find(h).text();a["goodWebUrl"]=$(this).find(i).attr("href");a["goodPrice"]=getPriceValue($(this).find(j).text());a["goodNumber"]=getPriceValue($(this).find(k).text());s.push(a)});b["consignee"]=m.trim();b["phone"]=l;b["consigneeAddress"]=strTrimSpace(n);b["payMethod"]=o;b["expressMethod"]=p;b["superiorUrl"]=_pluginInfo.type;b["buyGoods"]=s;b["totalPrice"]=getPriceValue(r);b["mac"]="无";b["ip"]="无";return b};function get_TM_OrderJson(){var c={};var d="div#J_addresses div[class='list'] div[class$='address-option-binded'] div[class='inner'] div[class='addr-hd'] span[class='name']";var e="div#J_addresses div[class='list'] div[class$='address-option-binded'] div[class='inner'] div[class='addr-hd'] span[class='prov']";var f="div#J_addresses div[class='list'] div[class$='address-option-binded'] div[class='inner'] div[class='addr-hd'] span[class='city']";var g="div#J_addresses div[class='list'] div[class$='address-option-binded'] div[class='inner'] div[class='addr-bd']";var h="div#J_addresses div[class='list'] div[class$='address-option-binded'] div[class='inner'] div[class='addr-bd'] span[class='phone']";var i="";var j="";var k="div#A_orders table[class^='grid-bundle']";var l="td[class='tube-master'] a";var m="td[class='tube-master'] a";var n="td[class='tube-amount'] div[class='tc-amount']";var o="td[class='tube-price']";var p="strong#J_RealPay";var q=$(d).text();var r=$(e).text()+$(f).text()+$(g).attr("title");var s=$(h).text();var t="在线支付";var u="普通配送";var v="";var w=new Array();$(k).each(function(){var a={};a["goodName"]=$(this).find(l).attr("title").trim();a["goodWebUrl"]=$(this).find(m).attr("href");var b=getPriceValue($(this).find("td[class='tube-sum']").text());a["goodNumber"]=getPriceValue($(this).find(n).text());a["goodPrice"]=Number(b)/Number(a["goodNumber"]);w.push(a)});var x=getPriceValue($(p).text());c["consignee"]=strTrimSpace(strTrimNum(q));c["phone"]=s;c["consigneeAddress"]=strTrimSpace(r);c["superiorUrl"]=_pluginInfo.type;c["payMethod"]=t;c["expressMethod"]=u;c["buyGoods"]=w;c["totalPrice"]=x;c["mac"]="暂时不能拿到";c["ip"]="无";return c};function get_SUNING_OrderJson(){var b={};var c="span#receiverShowDetail";var d="span#adressShowDetail";var e="div#paymethod div[class='mod-panel']";var f="";var g="table#oneKeyProL tbody tr[class!='Thead blue-background'][name!='beforeMerged']";var h="td:eq(1) a";var i="td:eq(1) a";var j="td:eq(2)";var k="td:eq(3)";var l="i#orderTotalI";var m=strTrimNum($(c).text());var n=getPhone($(c).text());var o=$(d).text();var p=$(e).text();var q="";var r="";var s=new Array();$(g).each(function(){if($(this).find("td").length>=4){var a={};a["goodName"]=$(this).find(h).attr("title");a["goodWebUrl"]=$(this).find(i).attr("href");a["goodPrice"]=getPriceValue($(this).find(j).text());a["goodNumber"]=getPriceValue($(this).find(k).text());s.push(a)}});var t=getPriceValue($(l).text());b["consignee"]=m;b["phone"]=n;b["consigneeAddress"]=strTrimSpace(o);b["payMethod"]=p;b["expressMethod"]=q;b["superiorUrl"]=_pluginInfo.type;b["buyGoods"]=s;b["totalPrice"]=t;b["mac"]="无";b["ip"]="无";return b};function get_YHD_OrderJson(){var c={};var d="div#addressList ul li[class='slt'] p b";var e="div#addressList ul li[class='slt'] p:eq(3)";var f="div#addressList ul li[class='slt'] p[class='listAddressShow']";var g="input[name='payment']:checked";var h="td[class='delivMehoedSltTxt']";var i="div[class='DeliveryInfoBox'] table tbody tr";var j="td:eq(0)";var k="td:eq(1)";var l="div#SellCountFixBox div i b";var m=$(d).text();var n=$(f).text();var o=$(e).text();var p=$(g).next().text().trim();var q=$(h).text().trim();var r="";var s=new Array();$(i).each(function(){var a={};a["goodName"]=$(this).find(j).text().trim();a["goodWebUrl"]="";var b=getPriceValue($(this).find("td:eq(3)").text());a["goodNumber"]=getPriceValue($(this).find(k).text());a["goodPrice"]=Number(b)/Number(a["goodNumber"]);s.push(a)});var t=getPriceValue($(l).text());c["consignee"]=strTrimSpace(strTrimNum(m));c["phone"]=o;c["consigneeAddress"]=strTrimSpace(n);c["payMethod"]=p;c["expressMethod"]=q;c["buyGoods"]=s;c["totalPrice"]=t;c["superiorUrl"]=_pluginInfo.type;c["mac"]="无";c["ip"]="无";return c};function get_GUOMEI_OrderJson(){var b={};var c="div#bt-address p span#bt-name";var d="div#bt-address p span:gt(1)";var e="span#tp-payWay";var f="em[class='nPadR15']";var g="dl[class='nProduct-tj'] dd[class='tjFirst clearfix']";var h="div[class='pCol-name g-pCol-name'] p a";var i="div[class='pCol-name g-pCol-name'] p a";var j="div[class='pCol-price']";var k="div[class='pCol-nums']";var l="div#bt-address p span#bt-cell";var m="b[class='nPrice nPadR10']";var n=$(c).text();var o=$(d).text();var p=$(l).text();var q=$(e).text().trim();var r="";var s="";$(f).each(function(){s+=$(this).text()+" "});var t=new Array();$(g).each(function(){var a={};a["goodName"]=$(this).find(h).attr("title").trim();a["goodWebUrl"]=$(this).find(i).attr("href");a["goodNumber"]=getPriceValue($(this).find(k).text());a["goodPrice"]=getPriceValue($(this).find(j).text());t.push(a)});var u=getPriceValue($(m).text());b["consignee"]=strTrimSpace(strTrimNum(n));b["phone"]=p;b["consigneeAddress"]=strTrimSpace(o);b["payMethod"]=q;b["expressMethod"]=s;b["buyGoods"]=t;b["totalPrice"]=u;b["superiorUrl"]=_pluginInfo.type;b["mac"]="无";b["ip"]="无";return b};function get_YAMAXUN_OrderJson(){var b={};var c="div#desktop-shipping-address-div div ul li[class='displayAddressLI displayAddressFullName']";var d="div#desktop-shipping-address-div div ul li[class='displayAddressLI displayAddressStateOrRegionCityDistrictOrCounty'][class='displayAddressLI displayAddressAddressLine1AddressLine2AddressLine3']";var e="span#externalpayment";var f="input[class='radio-standard no-js-hide']";var g="";var h="div[class='a-column a-span9 a-span-last']";var i="div[class='a-row'] strong[class='asin-title']";var j="div[class='pCol-name g-pCol-name'] p a";var k="div[class='a-row'] span[class='a-color-price a-spacing-micro'] strong";var l="div[class='a-row'] div[class='a-row quantity-block'] span[class='quantity-display']";var m="";var n="td[class='a-size-medium a-color-price a-align-bottom a-nowrap grand-total-price a-text-right'] strong";var o=$(c).text();var p=$(d).text();var q=g;var r=$(e).text().trim();var s="";$(f).each(function(){s+=$(this).next().text()+","});var t=new Array();$(h).each(function(){var a={};a["goodName"]=$(this).find(i).text().trim();a["goodWebUrl"]="";a["goodNumber"]=getPriceValue($(this).find(l).text());a["goodPrice"]=getPriceValue($(this).find(k).text());t.push(a)});var u=getPriceValue($(n).text());b["consignee"]=strTrimSpace(strTrimNum(o));b["phone"]=q;b["superiorUrl"]=_pluginInfo.type;b["consigneeAddress"]=strTrimSpace(p);b["payMethod"]=r;b["expressMethod"]=s;b["buyGoods"]=t;b["totalPrice"]=u;b["mac"]="暂时不能拿到";b["ip"]="无";return b};function get_XINDAN_OrderJson(){var c={};var d="input[name='addSel'][checked='checked']";var e="input[name='addSel'][checked='checked']";var f="div#paymentContentPanel div[class='cmnInfolist']";var g="select[class='cmnSelect selShip sellType']";var h="input[name='addSel'][checked='checked']";var i="table[id^='cellerTable'] tbody tr[class='']";var j="td[class='pro'] a";var k="td[class='pro'] a";var l="td[class='amt']";var m="li#priceTotalAmount";var n=$(d).parent().find("span#contactMan").text();var o=$(e).parent().find("span#address").text();var p=$(h).parent().find("span#tel").text();p=getPhone(p);var q=$(f).text().trim();var r="";$(g).each(function(){r+=$(this).find("option:selected").text()+","});var s="";var t=new Array();$(i).each(function(){var a={};a["goodName"]=$(this).find(j).attr("title").trim();a["goodWebUrl"]=$(this).find(k).attr("href");a["goodNumber"]=getPriceValue($(this).find(l).text());var b=getPriceValue($(this).find("td[class='money']").text());a["goodPrice"]=Number(b)/Number(a["goodNumber"]);t.push(a)});var u=getPriceValue($(m).text());c["consignee"]=strTrimSpace(strTrimNum(n));c["phone"]=p;c["consigneeAddress"]=strTrimSpace(o);c["superiorUrl"]=_pluginInfo.type;c["payMethod"]=q;c["expressMethod"]=r;c["buyGoods"]=t;c["totalPrice"]=u;c["mac"]="暂时不能拿到";c["ip"]="无";return c};function get_YXW_OrderJson(){var b={};var c="ul[class='order_address_list'] li[class='selected'] div[class='order_address_info'] label[class='radio_desp'] span[class='c2']";var d="ul[class='order_address_list'] li[class='selected'] div[class='order_address_info'] label[class='radio_desp'] span[class='c3']";var e="div#pay_box div:eq(1) ul[class='pay_list'] li[class='selected'] label[class='radio_desp'] span:eq(0)";var f="";var g="";var h="div#package_box div[class='package'] ul[class='package_bd_list'] li";var i="div[class='img_detail'] p[class='name'] a";var j="div[class='img_detail'] p[class='name'] a";var k="div[class='package_bd_amount ']";var l="div[class='package_bd_price ']";var m="#pr_totalprice";var n=$(c).text();var o=$(d).text();var p=getPhone(o);o=o.split("，")[0];var q=$(e).text();var r="京东自营快递";var s="";var t=new Array();$(h).each(function(){var a={};a["goodName"]=$(this).find(i).text();a["goodWebUrl"]=$(this).find(j).attr("href");a["goodNumber"]=getPriceValue($(this).find(k).text());a["goodPrice"]=getPriceValue($(this).find(l).text());t.push(a)});var u=getPriceValue($(m).text());b["consignee"]=strTrimSpace(strTrimNum(n));b["phone"]=p;b["consigneeAddress"]=strTrimSpace(o);b["superiorUrl"]=_pluginInfo.type;b["payMethod"]=q;b["expressMethod"]=r;b["buyGoods"]=t;b["totalPrice"]=u;b["mac"]="暂时不能拿到";b["ip"]="无";return b};function get_JX_OrderJson(){var b={};var c="div[class='orderAddress'] div[class='orderItem first on'] label b";var d="div[class='orderAddress'] div[class='orderItem first on'] label span";var e="div[class='paymentInfo'] ul li[class='selected'] label span:eq(0)";var f="";var g="";var h="div[class='productTable'] table tbody tr";var i="td:eq(0) div[class='productName'] p:eq(0) a";var j="td:eq(0) div[class='productName'] p:eq(0) a";var k="td:eq(2) div[class='productNum'] span";var l="td:eq(1) div[class='productPriM']";var m="#payPrice";var n=$(c).text();var o=$(d).text();var p=getPhone(o);o=o.replace(p,"");var q=$(e).text();var r="卖家自定";var s="";var t=new Array();$(h).each(function(){var a={};a["goodName"]=$(this).find(i).text();a["goodWebUrl"]=$(this).find(j).attr("href");a["goodNumber"]=getPriceValue($(this).find(k).text());a["goodPrice"]=getPriceValue($(this).find(l).text());t.push(a)});var u=getPriceValue($(m).text());b["consignee"]=strTrimSpace(strTrimNum(n));b["phone"]=p;b["consigneeAddress"]=strTrimSpace(o);b["superiorUrl"]=_pluginInfo.type;b["payMethod"]=q;b["expressMethod"]=r;b["buyGoods"]=t;b["totalPrice"]=u;b["mac"]="暂时不能拿到";b["ip"]="无";return b};function bindClickToSubmitBtn(b,c){$(c).on("click",function(){var a="";if(b=="JD"){if($("#wizard").length>0){a=get_JD2_OrderJson()}else if($("#content").length>0){a=get_JD_OrderJson()}};if(b=="SUNING"){a=get_SUNING_OrderJson()};if(b=="YHD"){a=get_YHD_OrderJson()};if(b=="GUOMEI"){a=get_GUOMEI_OrderJson()};if(b=="XINDAN"){a=get_XINDAN_OrderJson()};if(b=="TM"){a=get_TM_OrderJson()};if(b=="YXW"){a=get_YXW_OrderJson()};if(b=="JX"){a=get_JX_OrderJson()};orderPort.postMessage({name:"OlderInfoGot",data:a})})};function strTrim(a){return a.replace(/(\\t)*/g,"").replace(/(\\n)*/g,"")};function strTrimNum(a){return a.replace(/[0-9]*/g,"")};function strTrimSpace(a){return a.replace(/\s*/g,"")};function getPhone(a){var m=a.match(/\t*[0-9]{7,11}/);if(m)return m[0];return a};